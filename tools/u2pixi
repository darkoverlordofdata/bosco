#!/usr/bin/env coffee

fs = require('fs')
yaml = require('yamljs')

image = "Scavengers_SpriteSheet"
width = 256
height = 224

json = frames: {}, meta:
  app: "http://www.darkoverlordofdata.com/bosco"
  version: "1.0"
  image: "#{image}.png"
  format: "RGBA8888"
  size: w:width, h:height
  scale: "1"

unity = yaml.load("lib/res/#{image}.png.meta")

prefabs = {}
for id, sprite of unity.TextureImporter.fileIDToRecycleName
  prefab[id] = sprite


for sprite in unity.TextureImporter.spriteSheet.sprites

  x = sprite.rect.x
  y = sprite.rect.y
  w = sprite.rect.width
  h = sprite.rect.height

  json.frames[sprite.name] =
    frame: x:x, y:y, w:w, h:h
    rotated: false
    trimmed: false
    spriteSourceSize: x:0, y:0, w:w, h:h
    sourceSize: w:w, h:h


fs.writeFile("lib/res/#{image}.json", JSON.stringify(json, null, 2))