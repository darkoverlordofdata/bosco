var bosco;
(function(bosco){var utils;(function(utils){var Input=function(){function Input(){var _this=this;this.states={};this.mouseDown=false;this.mouseButtonDown=false;this.mousePosition={x:0,y:0};this.isDown=function(keyCode){return _this.states[keyCode]};this.isUp=function(keyCode){return!_this.states[keyCode]};this.onKeyUp=function(event){if(_this.states[event.keyCode])_this.states[event.keyCode]=false};this.onKeyDown=function(event){_this.states[event.keyCode]=true};this.onTouchStart=function(event){event=event.targetTouches?
event.targetTouches[0]:event;_this.mouseDown=true;_this.mouseButtonDown=true;_this.mousePosition.x=parseInt(event.clientX);_this.mousePosition.y=parseInt(event.clientY);return true};this.onTouchMove=function(event){event=event.targetTouches?event.targetTouches[0]:event;_this.mousePosition.x=parseInt(event.clientX);_this.mousePosition.y=parseInt(event.clientY)};this.onTouchEnd=function(event){_this.mouseDown=false;_this.mouseButtonDown=false};document.addEventListener("touchstart",this.onTouchStart,
true);document.addEventListener("touchmove",this.onTouchMove,true);document.addEventListener("touchend",this.onTouchEnd,true);document.addEventListener("mousedown",this.onTouchStart,true);document.addEventListener("mousemove",this.onTouchMove,true);document.addEventListener("mouseup",this.onTouchEnd,true);window.addEventListener("keydown",this.onKeyDown,true);window.addEventListener("keyup",this.onKeyUp,true)}Object.defineProperty(Input,"mousePosition",{get:function(){return Input._input.mousePosition},
enumerable:true,configurable:true});Input.getKeyDown=function(k){return Input._input.isDown(k.charCodeAt(0))};Input.getKeyUp=function(k){return Input._input.isUp(k.charCodeAt(0))};Input.getMouseButtonUp=function(m){return!Input._input.mouseButtonDown};Input.getMouseButton=function(m){return Input._input.mouseDown};Input.getMouseButtonDown=function(m){return Input._input.mouseButtonDown};Input.update=function(){Input._input.mouseDown=false;Input._input.states={}};Input._input=new Input;return Input}();
utils.Input=Input})(utils=bosco.utils||(bosco.utils={}))})(bosco||(bosco={}));var bosco;
(function(bosco){var utils;(function(utils){var Rnd=function(){function Rnd(){}Rnd.nextBool=function(){return(~~(Math.random()*32767)&1)===1};Rnd.nextDouble=function(){return Math.random()};Rnd.nextInt=function(max){return~~(Math.random()*max)};Rnd.random=function(start,end){if(end===undefined)return Rnd.nextInt(start+1);else if(parseInt(start)===parseFloat(start)&&parseInt(end)===parseFloat(end))return start+Rnd.nextInt(end-start+1);else return start+Rnd.nextDouble()*(end-start)};return Rnd}();utils.Rnd=
Rnd})(utils=bosco.utils||(bosco.utils={}))})(bosco||(bosco={}));var bosco;
(function(bosco){var utils;(function(utils){var TrigLUT=function(){function TrigLUT(){}TrigLUT.sin=function(rad){return TrigLUT.sin_[rad*TrigLUT.radToIndex&TrigLUT.SIN_MASK]};TrigLUT.cos=function(rad){return TrigLUT.cos_[rad*TrigLUT.radToIndex&TrigLUT.SIN_MASK]};TrigLUT.sinDeg=function(deg){return TrigLUT.sin_[deg*TrigLUT.degToIndex&TrigLUT.SIN_MASK]};TrigLUT.cosDeg=function(deg){return TrigLUT.cos_[deg*TrigLUT.degToIndex&TrigLUT.SIN_MASK]};TrigLUT.init=function(update){TrigLUT.RAD=Math.PI/180;TrigLUT.DEG=
180/Math.PI;TrigLUT.SIN_BITS=12;TrigLUT.SIN_MASK=~(-1<<TrigLUT.SIN_BITS);TrigLUT.SIN_COUNT=TrigLUT.SIN_MASK+1;TrigLUT.radFull=Math.PI*2;TrigLUT.degFull=360;TrigLUT.radToIndex=TrigLUT.SIN_COUNT/TrigLUT.radFull;TrigLUT.degToIndex=TrigLUT.SIN_COUNT/TrigLUT.degFull;TrigLUT.sin_=new Array(TrigLUT.SIN_COUNT);TrigLUT.cos_=new Array(TrigLUT.SIN_COUNT);for(var i=0;i<TrigLUT.SIN_COUNT;i++){TrigLUT.sin_[i]=Math.sin((i+.5)/TrigLUT.SIN_COUNT*TrigLUT.radFull);TrigLUT.cos_[i]=Math.cos((i+.5)/TrigLUT.SIN_COUNT*TrigLUT.radFull)}if(update){Math.sin=
TrigLUT.sin;Math.cos=TrigLUT.cos}};return TrigLUT}();utils.TrigLUT=TrigLUT})(utils=bosco.utils||(bosco.utils={}))})(bosco||(bosco={}));var bosco;
(function(bosco){var Sprite=PIXI.Sprite;var Texture=PIXI.Texture;function prefab(name){var config=bosco.config.resources[name];if(Array.isArray(config)){var container=new Sprite;for(var i=0,l=config.length;i<l;i++)container.addChild(prefab(config[i]));return container}else{var sprite=new Sprite(Texture.fromFrame(config.path));for(var k in config)switch(k){case "anchor":sprite.anchor.set(config.anchor.x,config.anchor.y);break;case "scale":sprite.scale.set(config.scale.x,config.scale.y);break;case "position":sprite.position.set(config.position.x,
config.position.y);break;case "rotation":sprite.rotation=config.rotation.z;break;case "tint":sprite.tint=config.tint;break}return sprite}}bosco.prefab=prefab})(bosco||(bosco={}));var bosco;
(function(bosco){var Properties=function(){function Properties(){}Properties.init=function(name,properties){if(Properties.db!==null)return;function initializeDb(db){if(db.isNew()){db.createTable("settings",["name","value"]);db.createTable("leaderboard",["date","score"]);for(var key in properties)if(properties.hasOwnProperty(key))db.insert("settings",{name:key,value:properties[key]});db.commit()}}Properties.dbname=name;Properties.properties=properties;if(window["chrome"])chromeStorageDB(Properties.dbname,
localStorage,function(db){return initializeDb(Properties.db=db)});else initializeDb(Properties.db=new localStorageDB(Properties.dbname))};Properties.get=function(prop){return Properties.db.queryAll("settings",{query:{name:prop}})[0].value};Properties.setScore=function(score){var today=new Date;var mm=(today.getMonth()+1).toString();if(mm.length===1)mm="0"+mm;var dd=today.getDate().toString();if(dd.length===1)dd="0"+dd;var yyyy=today.getFullYear().toString();var yyyymmdd=yyyy+mm+dd;if(0===Properties.db.queryAll("leaderboard",
{query:{date:yyyymmdd}}).length)Properties.db.insert("leaderboard",{date:yyyymmdd,score:score});else Properties.db.update("leaderboard",{date:yyyymmdd},function(row){if(score>row.score)row.score=score;return row});Properties.db.commit()};Properties.getLeaderboard=function(count){return Properties.db.queryAll("leaderboard",{limit:count,sort:[["score","DESC"]]})};Properties.db=null;Properties.dbname="";Properties.properties=null;Properties.set=function(prop,value){Properties.db.update("settings",{name:prop},
function(row){row.value=""+value;return row});Properties.db.commit()};return Properties}();bosco.Properties=Properties})(bosco||(bosco={}));var bosco;
(function(bosco){var Container=PIXI.Container;var Input=bosco.utils.Input;(function(ScaleType){ScaleType[ScaleType["FILL"]=0]="FILL";ScaleType[ScaleType["FIXED"]=1]="FIXED"})(bosco.ScaleType||(bosco.ScaleType={}));var ScaleType=bosco.ScaleType;bosco.config;function start(config){if(config.properties)bosco.Properties.init(config.namespace,config.properties);for(var asset in config.assets)PIXI.loader.add(asset,config.assets[asset]);PIXI.loader.load(function(loader,resources){return new Game(config,
resources)})}bosco.start=start;var DummyStats=function(){function DummyStats(){}DummyStats.prototype.begin=function(){};DummyStats.prototype.end=function(){};return DummyStats}();var Game=function(){function Game(config,resources){var _this=this;this.update=function(time){};this.resize=function(){var ratio=Math.min(window.innerWidth/_this.config.width,window.innerHeight/_this.config.height);_this.config.scale=ratio;_this.stage.scale.x=_this.stage.scale.y=ratio;_this.renderer.resize(Math.ceil(_this.config.width*
ratio),Math.ceil(_this.config.height*ratio))};var controllers=[];var temp;var previousTime;this.config=bosco.config=config;this.resources=resources;var renderer=this.renderer=PIXI.autoDetectRenderer(config.width,config.height,config.options);renderer.view.style.position="absolute";renderer.view.style.top="0px";renderer.view.style.left="0px";var stage=this.stage=new Container;viewContainer=this.sprites=new Container;foreContainer=this.fore=new Container;this.resize();document.body.appendChild(renderer.view);
if(config.stats){var stats=this.stats=new Stats;stats.setMode(0);stats.domElement.style.position="absolute";stats.domElement.style.left="0px";stats.domElement.style.top="0px";document.body.appendChild(stats.domElement);this.update=function(time){stats.begin();temp=previousTime||time;previousTime=time;var delta=(time-temp)*.001;for(var i=0,l=controllers.length;i<l;i++)controllers[i].update(delta);renderer.render(stage);stats.end();requestAnimationFrame(_this.update);Input.update();TWEEN.update()}}else this.update=
function(time){temp=previousTime||time;previousTime=time;var delta=(time-temp)*.001;for(var i=0,l=controllers.length;i<l;i++)controllers[i].update(delta);renderer.render(stage);requestAnimationFrame(_this.update);Input.update();TWEEN.update()};window.addEventListener("resize",this.resize,true);window.onorientationchange=this.resize;stage.addChild(this.sprites);stage.addChild(this.fore);for(var _i=0,_a=config.controllers;_i<_a.length;_i++){var className=_a[_i];var Class=window[config.namespace][className];
controllers.push(new Class)}for(var _b=0;_b<controllers.length;_b++){var controller=controllers[_b];controller.start()}requestAnimationFrame(this.update)}return Game}();bosco.Game=Game})(bosco||(bosco={}));
